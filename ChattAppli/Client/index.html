<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script>
			// $(document).ready(function() {
			// $("#btn2").click(function() {
			// $("ol").append("<li>Appended item</li>");
			// });
			// });

			$("#message").keyup(function(event) {
				if (event.keyCode == 13) {
					$("#send").click();
				}
			});

			var ws = new WebSocket("ws://10.0.0.17:8020/");

			ws.onopen = function() {
				// alert("Opened!");
				var person = prompt("Please enter your name");
				ws.send(person);
				setInterval(function() {
					ws.send("***KeepAlive***");
				}, 60000);
			};

			ws.onmessage = function(evt) {
				if (evt.data !== "***KeepAlive***") {
					$("ol").append("<li>" + evt.data + "</li>");
				}
			};

			function sendMessage() {
				var msg=document.getElementById("message").value;
				if(msg!==""){
				ws.send(msg);
				document.getElementById("message").value = "";
			}}

			function closeConnection() {
				ws.onclose = function() {
					alert("Closed!");
					ws.close();
				};
			}

			function onKeyDown(event) {
				if (event.keyCode == 13)
					sendMessage();
			}

		</script>
	</head>
	<body>
		<h1>WebSocket test</h1>

		Message:
		<input type="text" onkeydown="onKeyDown(event)" id="message" >

		<button id="send" onclick="sendMessage()">
			Send
		</button>
		<br />
		<br />
		<!-- <button onclick="closeConnection()">
		Close
		</button> -->
		<br />

		<ol></ol>

	</body>
</html>